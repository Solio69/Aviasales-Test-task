(this["webpackJsonpaviasales-clone"]=this["webpackJsonpaviasales-clone"]||[]).push([[0],{10:function(e,t,n){e.exports={filters:"Filters_filters__1LoYd","checkbox-input":"Filters_checkbox-input__12oe-","check-box":"Filters_check-box__1cpZR","checkbox-label":"Filters_checkbox-label__3cQ5f"}},19:function(e,t,n){e.exports={"sort-buttons":"SortButtons_sort-buttons__2VzwI",active:"SortButtons_active__1BCvX"}},20:function(e,t,n){e.exports={"loader-wrapper":"Loader_loader-wrapper__-qmbk",loader:"Loader_loader__1cw97"}},23:function(e,t,n){e.exports={"tickets-list":"TicketsList_tickets-list__3iqkw"}},24:function(e,t,n){e.exports={"notFound-message":"NotFoundAlert_notFound-message__1gjxn"}},25:function(e,t,n){e.exports={"error-message":"ErrorAlert_error-message__1opaR"}},26:function(e,t,n){e.exports={"button-show-more__wrapper":"Button_button-show-more__wrapper__e6eoO"}},3:function(e,t,n){e.exports={ticket:"Ticket_ticket__2Qq9N","ticket-header":"Ticket_ticket-header__swV95","ticket-header__prise":"Ticket_ticket-header__prise__yOPZH","ticket-content":"Ticket_ticket-content__3kTA1","ticket-content__column":"Ticket_ticket-content__column__3nj7x","ticket-content__column__inner-wrapper":"Ticket_ticket-content__column__inner-wrapper__3rrSw","ticket-content__title":"Ticket_ticket-content__title__3XdXC","ticket-content__text":"Ticket_ticket-content__text__2q0MU"}},40:function(e,t,n){},43:function(e,t,n){"use strict";n.r(t);var c=n(4),r=n(1),a=n(11),s=n.n(a),i=n(15),o=n(22),u=n(6),l=n(2),_={sortButtons:[{name:"inexpensive",label:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439",isActive:!0},{name:"quick",label:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439",isActive:!1},{name:"optimal",label:"\u041e\u043f\u0442\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439",isActive:!1}],filterItems:[{label:"\u0412\u0441\u0435",name:"all",isCheck:!0},{label:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",name:"0",isCheck:!0},{label:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",name:"1",isCheck:!0},{label:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",name:"2",isCheck:!0},{label:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",name:"3",isCheck:!0}],searchId:"",packetTickets:[],ticketsCounter:5,isStop:!1,error:null},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_SORT_BUTTONS":return Object(l.a)(Object(l.a)({},e),{},{sortButtons:t.payload});case"UPDATE_FILTERS":return Object(l.a)(Object(l.a)({},e),{},{filterItems:t.payload});case"UPDATE_SEARCH_ID":return Object(l.a)(Object(l.a)({},e),{},{searchId:t.payload});case"UPDATE_PACKET_TICKETS":return Object(l.a)(Object(l.a)({},e),{},{packetTickets:[].concat(Object(u.a)(e.packetTickets),Object(u.a)(t.payload))});case"UPDATE_TICKETS_COUNTER":return Object(l.a)(Object(l.a)({},e),{},{ticketsCounter:t.payload});case"TOGGLE_STOP":return Object(l.a)(Object(l.a)({},e),{},{isStop:t.payload});case"TICKETS_ERROR":return Object(l.a)(Object(l.a)({},e),{},{error:t.payload});default:return e}},d="object"===typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):i.b,j=Object(i.c)(p,d(Object(i.a)(o.a))),b=(n(40),n(13)),h=n(14),k=n(29),m=n(28),f=n(7),O=n.n(f),v=n(9),x=n.n(v),T=n(18),g=function(){function e(){Object(b.a)(this,e),this.baseStr="https://front-test.beta.aviasales.ru/"}return Object(h.a)(e,[{key:"getKey",value:function(){var e=Object(T.a)(x.a.mark((function e(){var t,n,c=this;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URL("".concat(this.baseStr,"search")),e.next=3,fetch(t).then((function(e){if(!e.ok)throw new Error("error fetch URL ".concat("".concat(c.baseStr,"search"),", response status ",e.status));return e.json()}));case 3:return n=e.sent,e.abrupt("return",n.searchId);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTickets",value:function(){var e=Object(T.a)(x.a.mark((function e(t){var n,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new URL("".concat(this.baseStr,"tickets"))).searchParams.set("searchId",t),e.prev=2,e.next=5,fetch(n).then((function(e){if(!e.ok)throw new Error("error fetch URL ".concat(n,", response status ").concat(e.status));return e.json()}));case 5:return c=e.sent,e.abrupt("return",c);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",{tickets:[]});case 12:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),w=new g,N=n.p+"static/media/Logo.9c35a983.svg",S=n(0),E=function(){return Object(S.jsx)("img",{src:N,alt:"logo"})},C=n(10),y=n.n(C),I=Object(c.b)((function(e){return{filterItems:e.filterItems}}),(function(e){return{updateFilters:function(t){return e(function(e){return{type:"UPDATE_FILTERS",payload:e}}(t))}}}))((function(e){var t=e.filterItems,n=e.updateFilters,c=0,r=Object(u.a)(t).map((function(e){var r=e.label,a=e.name,s=e.isCheck;s&&(c+=1);return Object(S.jsx)("li",{children:Object(S.jsxs)("label",{className:y.a["checkbox-label"],children:[Object(S.jsx)("input",{type:"checkbox",className:y.a["checkbox-input"],checked:s,onChange:function(e){var r=Object(u.a)(t);"all"===a&&!1===s&&r.map((function(e){return e.isCheck=!0,e})),"all"===a&&!0===s&&r.map((function(e){return e.isCheck=!1,e})),"all"!==a&&r.map((function(t){return t.name===a&&(t.isCheck=e.target.checked,e.target.checked||(c-=1)),"all"===t.name&&(t.isCheck=!1),t})),3===c&&"all"!==a&&r.map((function(e){return e.isCheck=!0,e})),n(r)}}),Object(S.jsx)("span",{className:y.a["check-box"]}),r]})},a)}));return Object(S.jsxs)("div",{className:y.a.filters,children:[Object(S.jsx)("div",{children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),Object(S.jsx)("ul",{children:r})]})})),A=n(19),P=n.n(A),R=function(e){var t=e.sortButtons,n=e.updateSortButtons,c=t.map((function(e){var c,r=e.name,a=e.label;e.isActive&&(c=P.a.active);var s=function(){var e=Object(u.a)(t).map((function(e){return e.name===r?e.isActive=!0:e.isActive=!1,e}));n(e)};return Object(S.jsx)("div",{onClick:s,onKeyDown:s,role:"button",tabIndex:0,className:c,children:a},r)}));return Object(S.jsx)("div",{className:P.a["sort-buttons"],children:c})};R.defaultProps={sortButtons:[]};var D=Object(c.b)((function(e){return{sortButtons:e.sortButtons}}),(function(e){return{updateSortButtons:function(t){return e(function(e){return{type:"UPDATE_SORT_BUTTONS",payload:e}}(t))}}}))(R),U=n(23),B=n.n(U),L=n(3),F=n.n(L),M=function(e){var t=e.ticket,n=e.filterItems,c=t.price,r=t.carrier,a=t.segments,s=a[0],i=a[1],o=function(e,t){switch(e){case 0:return t.find((function(e){return"0"===e.name})).label;case 1:return t.find((function(e){return"1"===e.name})).label;case 2:return t.find((function(e){return"2"===e.name})).label;case 3:return t.find((function(e){return"3"===e.name})).label;default:return""}},u=o(s.stops.length,n),l=o(i.stops.length,n),_=function(e,t){var n=new Date(e);return n.setMinutes(n.getMinutes()+t),n},p=new Date(s.date),d=_(p,s.duration),j=new Date(i.date),b=_(j,i.duration),h=function(e){return[String(e.getHours()),String(e.getMinutes())].map((function(e){return 2===e.length?e:1===e.length?"0"+e:0===e.length?"00"+e:void 0})).join(":")},k=h(p),m=h(d),f=h(j),O=h(b),v=function(e){var t="",n=e/60^0;if(n){var c=e%60;c<10&&(c="0".concat(c)),t="".concat(n,"\u0447 ").concat(c,"\u043c")}else t="".concat(e,"\u043c");return t},x=v(s.duration),T=v(i.duration),g=s.stops.join(", "),w=i.stops.join(", "),N=String(c).replace(/(\d)(?=(\d{3})+(\D|$))/g,"$1 "),E="//pics.avs.io/99/36/".concat(r,".png");return Object(S.jsxs)("div",{className:F.a.ticket,children:[Object(S.jsxs)("div",{className:F.a["ticket-header"],children:[Object(S.jsxs)("div",{className:F.a["ticket-header__prise"],children:[N," \u0440"]}),Object(S.jsx)("div",{className:F.a["ticket-header__logo"],children:Object(S.jsx)("img",{src:E,alt:"logo"})})]}),Object(S.jsxs)("div",{className:F.a["ticket-content"],children:[Object(S.jsxs)("div",{className:F.a["ticket-content__column"],children:[Object(S.jsxs)("div",{className:F.a["ticket-content__column__inner-wrapper"],children:[Object(S.jsxs)("div",{className:F.a["ticket-content__title"],children:[s.destination," \u2013 ",s.origin]}),Object(S.jsxs)("div",{className:F.a["ticket-content__text"],children:[k,"-",m]})]}),Object(S.jsxs)("div",{className:F.a["ticket-content__column__inner-wrapper"],children:[Object(S.jsxs)("div",{className:F.a["ticket-content__title"],children:[i.destination," \u2013 ",i.origin]}),Object(S.jsxs)("div",{className:F.a["ticket-content__text"],children:[f,"-",O]})]})]}),Object(S.jsxs)("div",{className:F.a["ticket-content__column"],children:[Object(S.jsxs)("div",{className:F.a["ticket-content__column__inner-wrapper"],children:[Object(S.jsx)("div",{className:F.a["ticket-content__title"],children:"\u0432 \u043f\u0443\u0442\u0438"}),Object(S.jsx)("div",{className:F.a["ticket-content__text"],children:x})]}),Object(S.jsxs)("div",{className:F.a["ticket-content__column__inner-wrapper"],children:[Object(S.jsx)("div",{className:F.a["ticket-content__title"],children:"\u0432 \u043f\u0443\u0442\u0438"}),Object(S.jsx)("div",{className:F.a["ticket-content__text"],children:T})]})]}),Object(S.jsxs)("div",{className:F.a["ticket-content__column"],children:[Object(S.jsxs)("div",{className:F.a["ticket-content__column__inner-wrapper"],children:[Object(S.jsx)("div",{className:F.a["ticket-content__title"],children:u}),Object(S.jsx)("div",{className:F.a["ticket-content__text"],children:g})]}),Object(S.jsxs)("div",{className:F.a["ticket-content__column__inner-wrapper"],children:[Object(S.jsx)("div",{className:F.a["ticket-content__title"],children:l}),Object(S.jsx)("div",{className:F.a["ticket-content__text"],children:w})]})]})]})]})};M.defaultProps={filterItems:[]};var K=Object(c.b)((function(e){return{filterItems:e.filterItems}}))(M),q=n(24),X=n.n(q),G=function(){return Object(S.jsx)("div",{className:X.a["notFound-message"],children:Object(S.jsx)("span",{children:"\u0420\u0435\u0439\u0441\u043e\u0432, \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0445 \u043f\u043e\u0434 \u0437\u0430\u0434\u0430\u043d\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b, \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e!"})})},V=n.p+"static/media/error_Icon.2fce6214.png",Z=n(25),H=n.n(Z),J=function(){return Object(S.jsxs)("div",{className:H.a["error-message"],children:[Object(S.jsx)("img",{src:V,alt:"error"}),Object(S.jsx)("span",{children:"Error!"})]})},Q=n(26),Y=n.n(Q),$=function(e){var t=e.ticketsCounter,n=e.updateTicketsCounter;return Object(S.jsx)("div",{className:Y.a["button-show-more__wrapper"],children:Object(S.jsx)("button",{type:"button",onClick:function(){n(t+5)},children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0435\u0449\u0435 5 \u0431\u0438\u043b\u0435\u0442\u043e\u0432!"})})};$.defaultProps={ticketsCounter:5};var z=Object(c.b)((function(e){return{ticketsCounter:e.ticketsCounter}}),(function(e){return{updateTicketsCounter:function(t){return e(function(e){return{type:"UPDATE_TICKETS_COUNTER",payload:e}}(t))}}}))($),W=function(e){var t=e.packetTickets,n=e.filterItems,c=e.sortButtons,r=e.error,a=e.ticketsCounter,s=n.map((function(e){return e.isCheck?Number(e.name):null})).filter((function(e){return null!==e})),i=c.find((function(e){return e.isActive})).name,o=t.map((function(e){var t=e.segments[0].duration+e.segments[1].duration;e.sumMin=t;var n=e.sumMin+e.price;return e.sumMinAndPrace=n,e})).filter((function(e){var t=e.segments[0].stops.length,n=e.segments[1].stops.length;if(s.includes(t)&&s.includes(n))return e})),u=function(e,t){switch(t){case"inexpensive":e.sort((function(e,t){return e.price>t.price?1:-1}));break;case"quick":e.sort((function(e,t){return e.sumMin>t.sumMin?1:-1}));break;case"optimal":e.sort((function(e,t){return e.sumMinAndPrace>t.sumMinAndPrace?1:-1}));break;default:return[]}return e}(o,i).map((function(e,t){if(t<a)return Object(S.jsx)(K,{ticket:e},t)})),l=o.length||r?null:Object(S.jsx)(G,{}),_=r?Object(S.jsx)(J,{}):null,p=o.length?Object(S.jsx)(z,{}):null;return Object(S.jsxs)("div",{className:B.a["tickets-list"],children:[u,l,_,p]})};W.defaultProps={packetTickets:[],error:null};var ee=Object(c.b)((function(e){return{packetTickets:e.packetTickets,filterItems:e.filterItems,sortButtons:e.sortButtons,error:e.error,ticketsCounter:e.ticketsCounter}}))(W),te=n(5),ne=n(27),ce=n(20),re=n.n(ce),ae=function(e){var t=e.isStop,n=e.packetTickets,c=Object(r.useState)("\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c \u0431\u0438\u043b\u0435\u0442\u044b..."),a=Object(te.a)(c,2),s=a[0],i=a[1],o=Object(r.useState)(0),u=Object(te.a)(o,2),l=u[0],_=u[1];Object(r.useEffect)((function(){_(t?100:l+4)}),[t,n]);return Object(S.jsxs)("div",{className:re.a["loader-wrapper"],children:[Object(S.jsx)(ne.a,{containerClassName:re.a.loader,height:"6px",color:"#2196F3",progress:l,shadow:!1,onLoaderFinished:function(){i(null)}}),Object(S.jsx)("span",{children:s})]})};ae.defaultProps={packetTickets:[]};var se=Object(c.b)((function(e){return{isStop:e.isStop,packetTickets:e.packetTickets}}))(ae),ie=function(e){Object(k.a)(n,e);var t=Object(m.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.updateSearchId,n=e.getPacketTickets,c=e.ticketsError;w.getKey().then((function(e){t(e),n(e)})).catch((function(e){c(e)}))}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.error,c=t.isStop,r=t.packetTickets,a=t.getPacketTickets,s=t.searchId;e.packetTickets!==r&&null===n&&!1===c&&a(s)}},{key:"render",value:function(){var e=this.props.error;return Object(S.jsxs)("div",{className:O.a.app,children:[Object(S.jsx)("header",{className:O.a.header,children:Object(S.jsx)("div",{className:O.a["header__logo-wrapper"],children:Object(S.jsx)(E,{})})}),Object(S.jsxs)("main",{className:O.a.main,children:[e?null:Object(S.jsx)(se,{}),Object(S.jsxs)("section",{className:O.a["main__content-wrapper"],children:[Object(S.jsx)("div",{children:Object(S.jsx)(I,{})}),Object(S.jsxs)("div",{className:O.a.main__content,children:[Object(S.jsx)("div",{children:Object(S.jsx)(D,{})}),Object(S.jsx)("div",{children:Object(S.jsx)(ee,{})})]})]})]})]})}}]),n}(r.Component);ie.defaultProps={packetTickets:[],error:!1,isStop:!1,searchId:""};var oe=Object(c.b)((function(e){return{error:e.error,isStop:e.isStop,searchId:e.searchId,packetTickets:e.packetTickets}}),(function(e){return{getPacketTickets:function(t){return e((n=t,function(e){w.getTickets(n).then((function(t){e({type:"UPDATE_PACKET_TICKETS",payload:t.tickets}),t.stop&&e({type:"TOGGLE_STOP",payload:t.stop})}))}));var n},updateSearchId:function(t){return e(function(e){return{type:"UPDATE_SEARCH_ID",payload:e}}(t))},ticketsError:function(t){return e(function(e){return{type:"TICKETS_ERROR",payload:e}}(t))}}}))(ie);s.a.render(Object(S.jsx)(c.a,{store:j,children:Object(S.jsx)(oe,{})}),document.getElementById("root"))},7:function(e,t,n){e.exports={app:"App_app__230aF",header:"App_header__3h1GZ","header__logo-wrapper":"App_header__logo-wrapper__1GrI5","header__burger-wrapper":"App_header__burger-wrapper__2jAqY",main:"App_main__12kVZ","main__content-wrapper":"App_main__content-wrapper__3RZy2",main__content:"App_main__content__1tehR"}}},[[43,1,2]]]);
//# sourceMappingURL=main.a7d8242c.chunk.js.map